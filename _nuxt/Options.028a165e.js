import{p as c}from"./pocketbase.0539cbe6.js";import{a as u,b as a,e as l,k as d,v as h,t as p,o as b}from"./entry.52ef0458.js";const _={name:"Options",data(){return{current:"",courses:"",loading_upd:!1}},props:{currentUser:c.currentUser},mounted(){this.courses=this.currentUser.subjects.replaceAll(":",","),this.current=this.currentUser.class,Object.keys(this.$refs).forEach(t=>{const e=this.$refs[t];e.innerHTML==this.current&&e.classList.add("selected")})},methods:{validCheck(){const t=document.getElementsByClassName("valid-check");let e=!0;for(let s=0;s<t.length;s++){const n=t[s];n.checkValidity()||(n.style.outline="3px dashed #942525",setTimeout(()=>{n.style.outline=""},4e3),e=!1)}return e},button_select(t){t.preventDefault();const e=t.srcElement;this.current=e.innerHTML;const s=document.getElementsByClassName("select");for(let n=0;n<s.length;n++){const r=s[n];if(e==r){e.classList.add("selected");continue}r.classList.remove("selected")}},loading(t){const e=t,s=t;s.disabled=!0;const n=t.innerHTML;var r="L\xE4dt";e.innerHTML=r+".",this.loading_upd=!0;var o=setInterval(()=>{if(!this.loading_upd){clearInterval(o),t.innerHTML=n,s.disabled=!1;return}e.innerHTML.length>r.length+3?e.innerHTML=r+".":e.innerHTML+="."},400)},async button_submit(t){if(!this.validCheck()){setTimeout(()=>{alert("Bitte richtige Werte in markierte felder eingeben...")},100);return}if(this.current==""){alert("Bitte eine Stufe angeben...");return}if(this.current==this.currentUser.class&&this.courses.replaceAll(",",":")==this.currentUser.subjects)return;this.loading(t.srcElement);const e={class:this.current,subjects:this.courses.replaceAll(", ",",").replaceAll(",",":")};try{await c.instance.collection("users").update(this.currentUser.id,e),await c.instance.collection("users").update(this.currentUser.id,{update:!0})}catch{alert("Ein unerwarteter Fehler ist aufgetreten, versuche es sp\xE4ter erneut..."),this.loading_upd=!1}this.loading_upd=!1}}};const f={id:"login",style:{"text-align":"center"}},m={id:"login-style",class:"area",pos:"bottom"},g=l("h2",{style:{"font-weight":"900","margin-top":"0"}},"DATEN \xC4NDERN",-1),v=l("label",null,"Kurse",-1),k=l("br",null,null,-1);function y(t,e,s,n,r,o){return b(),a("div",f,[l("div",m,[g,v,d(l("input",{onkeyup:"this.value = this.value.toUpperCase();",class:"valid-check","onUpdate:modelValue":e[0]||(e[0]=i=>r.courses=i),id:"courses",type:"text",placeholder:"E G1,D G4,M L1,MU G1",pattern:"^[A-Z]{1,2}\\d?\\s[A-Z][1-9](,\\s?[A-Z]{1,2}\\d?\\s[A-Z][1-9])*$",required:""},null,512),[[h,r.courses]]),l("label",null,"Stufe: "+p(r.current),1),l("button",{ref:"select_button_1",class:"select",onClick:e[1]||(e[1]=i=>o.button_select(i))},"EF",512),l("button",{ref:"select_button_2",class:"select",onClick:e[2]||(e[2]=i=>o.button_select(i))},"Q1",512),l("button",{ref:"select_button_3",class:"select",onClick:e[3]||(e[3]=i=>o.button_select(i))},"Q2",512),k,l("button",{onClick:e[4]||(e[4]=i=>o.button_submit(i)),style:{"background-color":"rgba(255, 255, 255, 0.162)","margin-top":"35px",width:"50vw"}},"AKTUALISIEREN")])])}const L=u(_,[["render",y]]);export{L as O};
