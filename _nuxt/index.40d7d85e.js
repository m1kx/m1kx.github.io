import{_ as y}from"./_plugin-vue_export-helper.a1a6add7.js";import{o as c,a,b as n,t as _,F as x,r as $,e as p,f as l,u as f,h as C,i as w,w as b,j as O,p as S,k as A}from"./entry.c6ab0e28.js";import{p as s}from"./pocketbase.0539cbe6.js";import{O as E}from"./Options.8c12095f.js";const D={name:"DataDisplay",props:{day_data:{type:Object,default:"Null"},heading:{type:String,default:"err"}},methods:{split_inner(t){return t.split("|")},fmt_data(){const t=this.day_data.hash.split("!!!");for(let e=0;e<t.length;e++)t[e]=t[e].split("|");return t}}},L={class:"data-display"},B={key:1};function T(t,e,i,h,r,d){return c(),a("div",L,[n("h2",null,_(i.heading),1),d.fmt_data()[0]!=""?(c(!0),a(x,{key:0},$(d.fmt_data(),(o,m)=>(c(),a("div",null,[n("p",null,[p(_(o[1])+" "+_(o[2])+" ",1),n("i",null,_(o[5]),1)])]))),256)):(c(),a("div",B," Keine Ereignisse "))])}const V=y(D,[["render",T]]),M={name:"Display",props:{currentUser:s.currentUser},data(){return{h_data:{hash:atob(this.currentUser.h_hash)},m_data:{hash:atob(this.currentUser.m_hash)},days:{day_1:"",day_2:""}}},async mounted(){const t=await s.instance.collection("times").getOne("ux8ausqmf2h57dd");this.days.day_1=t.day_1,this.days.day_2=t.day_2}},H={id:"display"},I={id:"display-container",class:"area",pos:"top"},R=n("div",{id:"seperator"},null,-1);function j(t,e,i,h,r,d){const o=V;return c(),a("div",H,[n("div",I,[l(o,{day_data:r.h_data,heading:r.days.day_1},null,8,["day_data","heading"]),R,l(o,{day_data:r.m_data,heading:r.days.day_2},null,8,["day_data","heading"])])])}const F=y(M,[["render",j]]),W={name:"ScoreDisplay",data(){return{list:[]}},async mounted(){const t=await s.instance.collection("users").getFullList(200,{});this.list=t,this.list.sort((e,i)=>i.score+i.h_score-(e.score+e.h_score)),this.list.splice(5,this.list.length-5)}},K={class:"area",id:"score-display"},z={id:"score-content"},G=n("h2",null,"EVA SCORE",-1),J=n("h3",null,"DEIN SCORE",-1),P=n("h3",null,"TOP 5 SCORE",-1),q={id:"your-score",class:"score"},Q=n("div",{id:"score-seperator"},null,-1),Y={id:"top-score",class:"score"},X={key:0},Z={key:0,style:{color:"rgb(157, 241, 154)"}},tt={key:1};function et(t,e,i,h,r,d){return c(),a("div",K,[n("div",z,[G,J,P,n("div",q,[n("div",null,[n("h2",null,_(f(s).currentUser.score+f(s).currentUser.h_score),1)])]),Q,n("div",Y,[n("div",null,[(c(!0),a(x,null,$(r.list,(o,m)=>(c(),a("div",null,[o.score+o.h_score!=0?(c(),a("div",X,[o.id==f(s).currentUser.id?(c(),a("div",Z,_(o.score+o.h_score),1)):(c(),a("div",tt,_(o.score+o.h_score),1))])):C("",!0)]))),256))])])])])}const nt=y(W,[["render",et]]);function st(t){const e="=".repeat((4-t.length%4)%4),i=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),h=window.atob(i);return Uint8Array.from([...h].map(r=>r.charCodeAt(0)))}async function it(){try{const t=await navigator.serviceWorker.ready,e="BOYI_ijgk8RgymTmVmEu9_Kmtpun5-R790EByhTQ26Ba33WRo3LOg93BhUAFD3cvnVaCCR9tyH1lMiN8xuDlDbA",i=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:st(e)});return await s.instance.collection("users").update(s.currentUser.id,{notifications:JSON.stringify(i)}),!0}catch(t){return console.log(t),alert(`Error: Version nicht unterstuetzt /
Benachrichtigungen abgelehnt`),!1}}var ot;const rt={subscribe:it,registration:ot},ct={name:"EnableNotification",data(){return{notifications:!1}},mounted(){this.notifications=s.currentUser.notifications!=""},methods:{async clicked(){if(this.has_notifications()){await s.instance.collection("users").update(s.currentUser.id,{notifications:""}),this.notifications=!1;return}navigator.serviceWorker.register("service-worker.js");const e=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(e)await s.instance.collection("users").update(s.currentUser.id,{notifications:JSON.stringify(e)}),this.notifications=!0;else{const i=await rt.subscribe();this.notifications=i}},has_notifications(){return s.currentUser.notifications!=""}}};function at(t,e,i,h,r,d){return c(),a("button",{class:w({disablenotification:r.notifications}),id:"notify",onClick:e[0]||(e[0]=(...o)=>d.clicked&&d.clicked(...o))},"BENACHRICHTIGUNGEN",2)}const dt=y(ct,[["render",at]]),_t={components:{Options:E},data(){return{currentUser:s.instance.authStore.model}},methods:{loading(t){const e=t;var i="L\xE4dt";e.innerHTML=i+".",setInterval(function(){e.innerHTML.length>i.length+3?e.innerHTML=i+".":e.innerHTML+="."},400)},async signOut(t){this.loading(t.srcElement),s.instance.authStore.clear()},async deleteAccount(t){const e=prompt("Willst du den Account wirklich l\xF6schen? (ja/nein)");this.currentUser&&e=="ja"&&s.instance.collection("users").delete(this.currentUser.id)}},mounted(){s.instance.authStore.onChange(t=>{this.currentUser=s.instance.authStore.model})}};const u=t=>(S("data-v-95e5d101"),t=t(),A(),t),lt={id:"main-content"},ut={key:0,id:"main-settings"},ht={key:0},pt={id:"main-heading"},ft=u(()=>n("br",null,null,-1)),yt=u(()=>n("br",null,null,-1)),mt={id:"mail-notify"},gt={key:1},vt=u(()=>n("p",{id:"confirm"},"Bitte email best\xE4tigen und danach neu laden",-1)),Ut=[vt],bt={key:1},xt=u(()=>n("h1",null,"LMG Vertretungsplan Bot \u{1F916}",-1)),$t=u(()=>n("p",null,"Automatische Nachrichten zu deinen aktuellen Vertetungen/Entf\xE4llen (beta)",-1)),Et=u(()=>n("button",{id:"signin"},"ANMELDEN",-1)),kt=u(()=>n("button",{id:"signin"},"ACCOUNT ERSTELLEN",-1));function Nt(t,e,i,h,r,d){var U;const o=F,m=nt,k=E,N=dt,v=O;return c(),a("div",lt,[r.currentUser?(c(),a("div",ut,[r.currentUser.verified?(c(),a("div",ht,[n("h1",pt,"HALLO, "+_((U=r.currentUser)==null?void 0:U.email.split("@")[0].toUpperCase()),1),l(o,{currentUser:r.currentUser},null,8,["currentUser"]),l(m),l(k,{currentUser:r.currentUser},null,8,["currentUser"]),l(N),n("p",null,[p("Angemeldet!"),ft,p("(user-id: "+_(f(s).currentUser.id)+")",1),yt,p("( "),n("i",mt,_(f(s).currentUser.email),1),p(")")])])):(c(),a("div",gt,Ut)),n("button",{id:"signout",onClick:e[0]||(e[0]=g=>d.signOut(g))},"ABMELDEN"),n("button",{id:"delete",onClick:e[1]||(e[1]=g=>d.deleteAccount(g))},"ACCOUNT L\xD6SCHEN")])):(c(),a("div",bt,[xt,$t,l(v,{to:"/login"},{default:b(()=>[Et]),_:1}),l(v,{to:"/signup"},{default:b(()=>[kt]),_:1})]))])}const At=y(_t,[["render",Nt],["__scopeId","data-v-95e5d101"]]);export{At as default};
