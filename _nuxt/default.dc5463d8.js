import{_ as i}from"./_plugin-vue_export-helper.a1a6add7.js";import{o as u,a as l,b as _,q as p,s as h,f as d}from"./entry.6e4e58db.js";import{p as s}from"./pocketbase.0539cbe6.js";const f={name:"HealthCheck",props:{bot_status:{type:String,default:""}},data(){return{clicks:0}},methods:{navigatetoerr(){var t;this.clicks++,this.bot_status=="sad"&&this.clicks>10&&((t=window.open("https://bot.mikadev.tech/app/api/health","_blank"))==null||t.focus())}}},m=["src"];function b(t,e,a,o,r,n){return u(),l("div",{id:"health",onClick:e[0]||(e[0]=(...c)=>n.navigatetoerr&&n.navigatetoerr(...c))},[_("img",{src:`robot_${a.bot_status}.svg`},null,8,m)])}const k=i(f,[["render",b]]),{$sentrySetUser:g}=p();s.currentUser&&g({email:s.currentUser.email,user_id:s.currentUser.id});const v={data(){return{robot_status:"happy"}},methods:{async check_status(){try{(await(await fetch("https://bot.mikadev.tech/app/api/health")).json()).Status=="alive"?this.robot_status="happy":this.robot_status="sad"}catch(t){console.log(t),this.robot_status="sad"}},urlBase64ToUint8Array(t){const e="=".repeat((4-t.length%4)%4),a=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(a);return Uint8Array.from([...o].map(r=>r.charCodeAt(0)))}},mounted(){this.check_status(),setInterval(()=>{this.check_status()},9e3),window.onfocus=async()=>{!s.currentUser||await s.instance.collection("users").authRefresh()}}};function w(t,e,a,o,r,n){const c=k;return u(),l("div",null,[h(t.$slots,"default"),d(c,{bot_status:r.robot_status},null,8,["bot_status"])])}const x=i(v,[["render",w]]);export{x as default};
