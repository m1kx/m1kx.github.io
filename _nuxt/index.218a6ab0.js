import{u as M}from"./pocketbase.452a775a.js";import{a as F,r as N,b as P,e as L,f as I,w as K,u as p,h as W,i as D,o as f,j as m,k as r,t as k,F as T,l as B,m as G,p as U,q as V,s as x,v as Z,x as q,y as Q,z as Y,A as j,B as R,C as J,D as X,E as ee}from"./entry.bfe44b84.js";import{_ as te}from"./_plugin-vue_export-helper.a1a6add7.js";const ne=()=>null;function z(...u){var c,g,v,E,C,O,H;const o=typeof u[u.length-1]=="string"?u.pop():void 0;typeof u[0]!="string"&&u.unshift(o);let[e,a,t={}]=u;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof a!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(c=t.server)!=null?c:!0,t.default=(g=t.default)!=null?g:ne,t.lazy=(v=t.lazy)!=null?v:!1,t.immediate=(E=t.immediate)!=null?E:!0;const n=F(),h=()=>n.isHydrating?n.payload.data[e]:n.static.data[e],i=()=>h()!==void 0;n._asyncData[e]||(n._asyncData[e]={data:N((H=(O=h())!=null?O:(C=t.default)==null?void 0:C.call(t))!=null?H:null),pending:N(!i()),error:N(n.payload._errors[e]?P(n.payload._errors[e]):null)});const s={...n._asyncData[e]};s.refresh=s.execute=(b={})=>{if(n._asyncDataPromises[e]){if(b.dedupe===!1)return n._asyncDataPromises[e];n._asyncDataPromises[e].cancelled=!0}if(b._initial&&i())return h();s.pending.value=!0;const w=new Promise((y,S)=>{try{y(a(n))}catch(A){S(A)}}).then(y=>{if(w.cancelled)return n._asyncDataPromises[e];t.transform&&(y=t.transform(y)),t.pick&&(y=se(y,t.pick)),s.data.value=y,s.error.value=null}).catch(y=>{var S,A;if(w.cancelled)return n._asyncDataPromises[e];s.error.value=y,s.data.value=p((A=(S=t.default)==null?void 0:S.call(t))!=null?A:null)}).finally(()=>{w.cancelled||(s.pending.value=!1,n.payload.data[e]=s.data.value,s.error.value&&(n.payload._errors[e]=P(s.error.value)),delete n._asyncDataPromises[e])});return n._asyncDataPromises[e]=w,n._asyncDataPromises[e]};const _=()=>s.refresh({_initial:!0}),d=t.server!==!1&&n.payload.serverRendered;{const b=W();if(b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const y=b._nuxtOnBeforeMountCbs;b&&(L(()=>{y.forEach(S=>{S()}),y.splice(0,y.length)}),I(()=>y.splice(0,y.length)))}d&&n.isHydrating&&i()?s.pending.value=!1:b&&(n.payload.serverRendered&&n.isHydrating||t.lazy)&&t.immediate?b._nuxtOnBeforeMountCbs.push(_):t.immediate&&_(),t.watch&&K(t.watch,()=>s.refresh());const w=n.hook("app:data:refresh",y=>{if(!y||y.includes(e))return s.refresh()});b&&I(w)}const l=Promise.resolve(n._asyncDataPromises[e]).then(()=>s);return Object.assign(l,s),l}function se(u,o){const e={};for(const a of o)e[a]=u[a];return e}const ae={key:0,class:"data-display"},oe={key:0},re={key:1},ie=D({__name:"DataDisplay",props:{heading:null,day:null},setup(u){const o=u,e=M();var a=e.authStore.model;e.authStore.onChange(h=>{a=e.authStore.model,window.location.reload()});var t=[];function n(h){let i=[];o.day=="h"?i=atob(h.h_hash).split("!!!"):i=atob(h.m_hash).split("!!!");for(let s=0;s<i.length;s++)i[s]=i[s].split("|");t=i}return L(()=>{!a||e.collection("users").subscribe(a.id,async h=>{n(h.record)})}),n(a),(h,i)=>p(t)?(f(),m("div",ae,[r("h2",null,k(u.heading),1),p(t)[0]!=""?(f(),m("div",oe,[(f(!0),m(T,null,B(p(t),(s,_)=>(f(),m("div",{key:_},[r("p",null,[G(k(s[1])+" "+k(s[2])+" ",1),r("i",null,k(s[5]),1)])]))),128))])):(f(),m("div",re," Keine Ereignisse "))])):U("",!0)}}),ce={id:"display-container",class:"area",pos:"top"},le=r("div",{id:"seperator"},null,-1),ue=D({__name:"Display",async setup(u){let o,e;const a=M();a.authStore.model,a.authStore.onChange(n=>{a.authStore.model});const{data:t}=([o,e]=V(async()=>z("dates",async()=>{const n=await a.collection("times").getOne("ux8ausqmf2h57dd");return{day_1:n.day_1,day_2:n.day_2}})),o=await o,e(),o);return(n,h)=>{var s,_;const i=ie;return f(),m("div",ce,[x(i,{heading:(s=p(t))==null?void 0:s.day_1,day:"h"},null,8,["heading"]),le,x(i,{heading:(_=p(t))==null?void 0:_.day_2,day:"m"},null,8,["heading"])])}}}),de={class:"area",id:"score-display"},_e={id:"score-content"},he=r("h2",null,"EVA SCORE",-1),pe=r("h3",null,"DEIN SCORE",-1),fe=r("h3",null,"TOP 5 SCORE",-1),me={id:"your-score",class:"score"},ye={style:{margin:"0"}},ge=r("div",{id:"score-seperator"},null,-1),ve={id:"top-score",class:"score"},be={key:0},ke={key:0,style:{color:"rgb(157, 241, 154)"}},xe={key:1},Ee=D({__name:"ScoreDisplay",async setup(u){let o,e;const a=M();var t=a.authStore.model;a.authStore.onChange(s=>{t=a.authStore.model});var n=[],h=0;const{data:i}=([o,e]=V(async()=>z("users",async()=>{n=await a.collection("users").getFullList(200,{}),n.sort((_,d)=>d.score+d.h_score-(_.score+_.h_score));for(let _=0;_<n.length;_++)if(n[_].id==(t==null?void 0:t.id)){h=_+1;break}return n.splice(5,n.length-5),n})),o=await o,e(),o);return(s,_)=>{var d,l;return f(),m("div",de,[r("div",_e,[he,pe,fe,r("div",me,[r("div",null,[r("h2",null,k(((d=p(t))==null?void 0:d.score)+((l=p(t))==null?void 0:l.h_score)),1),r("h6",ye,"(Platz "+k(p(h))+")",1)])]),ge,r("div",ve,[r("div",null,[(f(!0),m(T,null,B(p(i),(c,g)=>{var v;return f(),m("div",{key:g},[c.score+c.h_score!=0?(f(),m("div",be,[c.id==((v=p(t))==null?void 0:v.id)?(f(),m("div",ke,k(c.score+c.h_score),1)):(f(),m("div",xe,k(c.score+c.h_score),1))])):U("",!0)])}),128))])])])])}}}),Ce={id:"login-style",class:"area",pos:"bottom",style:{"text-align":"center"}},De=r("h2",{style:{"font-weight":"900","margin-top":"0"}},"DATEN \xC4NDERN",-1),we=r("label",null,"Kurse",-1),Se=r("br",null,null,-1),Me=D({__name:"Options",setup(u){const o=M();var e=o.authStore.model;o.authStore.onChange(d=>{e=o.authStore.model});var a=N(""),t="",n=!1;function h(){const d=document.getElementsByClassName("valid-check");let l=!0;for(let c=0;c<d.length;c++){const g=d[c];g.checkValidity()||(g.style.outline="3px dashed #942525",setTimeout(()=>{g.style.outline=""},4e3),l=!1)}return l}function i(d){d.preventDefault();const l=d.srcElement;a.value=l.innerHTML;const c=document.getElementsByClassName("select");for(let g=0;g<c.length;g++){const v=c[g];if(l==v){l.classList.add("selected");continue}v.classList.remove("selected")}}function s(d){const l=d,c=d;c.disabled=!0;const g=d.innerHTML;var v="L\xE4dt";l.innerHTML=v+".",n=!0;var E=setInterval(()=>{if(!n){clearInterval(E),d.innerHTML=g,c.disabled=!1;return}l.innerHTML.length>v.length+3?l.innerHTML=v+".":l.innerHTML+="."},400)}async function _(d){if(!h()){setTimeout(()=>{alert("Bitte richtige Werte in markierte felder eingeben...")},100);return}if(a.value==""){alert("Bitte eine Stufe angeben...");return}if(a.value==e.class&&t.replaceAll(",",":")==e.subjects)return;s(d.srcElement);const l={class:a.value,subjects:t.replaceAll(", ",",").replaceAll(",",":"),new_update:!0};try{if(!e)return;await o.collection("users").update(e.id,l)}catch{alert("Ein unerwarteter Fehler ist aufgetreten, versuche es sp\xE4ter erneut..."),n=!1}n=!1}return L(()=>{!e||(t=e.subjects.replaceAll(":",","),a.value=e.class,o.collection("users").subscribe(e.id,async d=>{t=d.record.subjects.replaceAll(":",",")}))}),(d,l)=>(f(),m("div",Ce,[De,we,Z(r("input",{onkeyup:"this.value = this.value.toUpperCase();",class:"valid-check","onUpdate:modelValue":l[0]||(l[0]=c=>Q(t)?t.value=c:t=c),id:"courses",type:"text",placeholder:"E G1,D G4,M L1,MU G1",pattern:"^[A-Z]{1,2}\\d?\\s[A-Z][1-9](,\\s?[A-Z]{1,2}\\d?\\s[A-Z][1-9])*$",required:""},null,512),[[q,p(t)]]),r("label",null,"Stufe: "+k(p(a)),1),r("button",{ref:"select_button_1",class:"select",onClick:l[1]||(l[1]=c=>i(c))},"EF",512),r("button",{ref:"select_button_2",class:"select",onClick:l[2]||(l[2]=c=>i(c))},"Q1",512),r("button",{ref:"select_button_3",class:"select",onClick:l[3]||(l[3]=c=>i(c))},"Q2",512),Se,r("button",{id:"update-button",onClick:l[4]||(l[4]=c=>_(c)),style:{"background-color":"rgba(255, 255, 255, 0.162)","margin-top":"23px",width:"50vw","font-size":"15px"}},"DATEN AKTUALISIEREN")]))}});function $e(u){const o="=".repeat((4-u.length%4)%4),e=(u+o).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(e);return Uint8Array.from([...a].map(t=>t.charCodeAt(0)))}async function Ae(){try{const u=await navigator.serviceWorker.ready,o="BOYI_ijgk8RgymTmVmEu9_Kmtpun5-R790EByhTQ26Ba33WRo3LOg93BhUAFD3cvnVaCCR9tyH1lMiN8xuDlDbA",e=await u.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:$e(o)});return await pb.instance.collection("users").update(pb.currentUser.id,{notifications:JSON.stringify(e)}),!0}catch(u){return console.log(u),alert(`Error: Version nicht unterstuetzt /
Benachrichtigungen abgelehnt`),!1}}var Ne;const Le={subscribe:Ae,registration:Ne},Te=D({__name:"EnableNotification",setup(u){const o=M();var e=o.authStore.model;o.authStore.onChange(h=>{e=o.authStore.model});var a=!1;function t(){return e?e.notifications!="":!1}async function n(){if(t()&&e){await o.collection("users").update(e.id,{notifications:""}),a=!1;return}navigator.serviceWorker.register("service-worker.js");const i=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(!i)a=await Le.subscribe();else{if(!e)return;await o.collection("users").update(e.id,{notifications:JSON.stringify(i)}),a=!0}}return L(()=>{!e||(a=e.notifications!="")}),(h,i)=>(f(),m("button",{class:Y({disablenotification:p(a)}),id:"notify",onClick:n},"PUSH BENACHRICHTIGUNGEN",2))}}),Be=D({__name:"BackgroundShape",setup(u){const e=Math.floor(Math.random()*11+0)>5?"50%":"0%",a=250,t=500,n=Math.floor(Math.random()*(document.body.clientWidth-0+1)+0),h=Math.floor(Math.random()*(document.body.clientHeight*1.7-t-0+1)+0),i=Math.floor(Math.random()*(t-a+1)+a);var s=Math.floor(Math.random()*360),_="hsl("+s+", 100%, 85%)";return(d,l)=>(f(),m("div",{class:"bg-shape",style:j(`border-radius: ${p(e)}; transform: translateX(${p(n)}px) translateY(${p(h)}px); background-color: ${p(_)}; width: ${p(i)}px; height: ${p(i)}px;`)},null,4))}}),$=u=>(X("data-v-ae3477ef"),u=u(),ee(),u),Oe={class:"container-main"},He={id:"main-content"},Pe={key:0,id:"main-settings"},Ie={key:0,id:"main-settings"},Re={id:"main-heading"},Ue={key:1},Ve=$(()=>r("p",{id:"confirm"},"Bitte email best\xE4tigen und danach neu laden",-1)),je=[Ve],ze={key:1},Fe=$(()=>r("h1",null,"LMG Vertretungsplan Bot \u{1F916}",-1)),Ke=$(()=>r("p",null,"Automatische Nachrichten zu deinen aktuellen Vertetungen/Entf\xE4llen (beta)",-1)),We=$(()=>r("button",{id:"signin"},"ANMELDEN",-1)),Ge=$(()=>r("button",{id:"signin"},"ACCOUNT ERSTELLEN",-1)),Ze={id:"background"},qe=D({__name:"index",setup(u){const o=M();var e=o.authStore.model;o.authStore.onChange(i=>{e=o.authStore.model,window.location.reload()});function a(i){const s=i;var _="L\xE4dt";s.innerHTML=_+".",setInterval(function(){s.innerHTML.length>_.length+3?s.innerHTML=_+".":s.innerHTML+="."},400)}async function t(i){a(i.srcElement),o.authStore.clear()}async function n(i){const s=prompt("Willst du den Account wirklich l\xF6schen? (ja/nein)");e&&s=="ja"&&o.collection("users").delete(e.id)}const h=document.body.clientHeight*1.8;return(i,s)=>{var E;const _=ue,d=Ee,l=Me,c=Te,g=J,v=Be;return f(),m("div",Oe,[r("div",He,[p(e)?(f(),m("div",Pe,[p(e).verified?(f(),m("div",Ie,[r("h1",Re,"HALLO, "+k((E=p(e))==null?void 0:E.email.split("@")[0].toUpperCase()),1),x(_),x(d),x(l),x(c)])):(f(),m("div",Ue,je)),r("button",{id:"signout",onClick:s[0]||(s[0]=C=>t(C))},"ABMELDEN"),r("button",{id:"delete",onClick:s[1]||(s[1]=C=>n())},"ACCOUNT L\xD6SCHEN")])):(f(),m("div",ze,[Fe,Ke,x(g,{to:"/login"},{default:R(()=>[We]),_:1}),x(g,{to:"/signup"},{default:R(()=>[Ge]),_:1})]))]),r("div",{id:"background-blur",style:j(`height: ${h}px;`)},null,4),r("div",Ze,[(f(),m(T,null,B(10,C=>x(v,{key:C})),64))])])}}});const Xe=te(qe,[["__scopeId","data-v-ae3477ef"]]);export{Xe as default};
