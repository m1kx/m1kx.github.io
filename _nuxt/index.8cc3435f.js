import{_ as m}from"./_plugin-vue_export-helper.a1a6add7.js";import{o,a as r,b as n,t as _,F as $,r as k,e as y,f as l,u as p,h as b,w as x,i as S,p as C,j as L}from"./entry.93406e0d.js";import{p as i}from"./pocketbase.0539cbe6.js";import{O as E}from"./Options.752f757c.js";const A={name:"DataDisplay",props:{day_data:{type:Object,default:"Null"},heading:{type:String,default:"err"}},methods:{split_inner(e){return e.split("|")},fmt_data(){const e=this.day_data.hash.split("!!!");for(let t=0;t<e.length;t++)e[t]=e[t].split("|");return e}}},D={class:"data-display"},T={key:1};function w(e,t,a,h,c,d){return o(),r("div",D,[n("h2",null,_(a.heading),1),d.fmt_data()[0]!=""?(o(!0),r($,{key:0},k(d.fmt_data(),(s,f)=>(o(),r("div",null,[n("p",null,[y(_(s[1])+" "+_(s[2])+" ",1),n("i",null,_(s[5]),1)])]))),256)):(o(),r("div",T," Keine Ereignisse "))])}const B=m(A,[["render",w]]),M={name:"Display",props:{currentUser:i.currentUser},data(){return{h_data:{hash:atob(this.currentUser.h_hash)},m_data:{hash:atob(this.currentUser.m_hash)},days:{day_1:"",day_2:""}}},async mounted(){const e=await i.instance.collection("times").getOne("ux8ausqmf2h57dd");this.days.day_1=e.day_1,this.days.day_2=e.day_2}},H={id:"display"},V={id:"display-container",class:"area",pos:"top"},I=n("div",{id:"seperator"},null,-1);function R(e,t,a,h,c,d){const s=B;return o(),r("div",H,[n("div",V,[l(s,{day_data:c.h_data,heading:c.days.day_1},null,8,["day_data","heading"]),I,l(s,{day_data:c.m_data,heading:c.days.day_2},null,8,["day_data","heading"])])])}const j=m(M,[["render",R]]),F={name:"ScoreDisplay",data(){return{list:[]}},async mounted(){const e=await i.instance.collection("users").getFullList(200,{});this.list=e,this.list.sort((t,a)=>a.score+a.h_score-(t.score+t.h_score)),this.list.splice(5,this.list.length-5)}},W={class:"area",id:"score-display"},J={id:"score-content"},K=n("h2",null,"EVA SCORE",-1),G=n("h3",null,"DEIN SCORE",-1),P=n("h3",null,"TOP 5 SCORE",-1),q={id:"your-score",class:"score"},z=n("div",{id:"score-seperator"},null,-1),Q={id:"top-score",class:"score"},Y={key:0},X={key:0,style:{color:"rgb(157, 241, 154)"}},Z={key:1};function ee(e,t,a,h,c,d){return o(),r("div",W,[n("div",J,[K,G,P,n("div",q,[n("div",null,[n("h2",null,_(p(i).currentUser.score+p(i).currentUser.h_score),1)])]),z,n("div",Q,[n("div",null,[(o(!0),r($,null,k(c.list,(s,f)=>(o(),r("div",null,[s.score+s.h_score!=0?(o(),r("div",Y,[s.id==p(i).currentUser.id?(o(),r("div",X,_(s.score+s.h_score),1)):(o(),r("div",Z,_(s.score+s.h_score),1))])):b("",!0)]))),256))])])])])}const te=m(F,[["render",ee]]);function ne(e){const t="=".repeat((4-e.length%4)%4),a=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),h=window.atob(a);return Uint8Array.from([...h].map(c=>c.charCodeAt(0)))}function se(){navigator.serviceWorker.ready.then(function(e){const t="BOYI_ijgk8RgymTmVmEu9_Kmtpun5-R790EByhTQ26Ba33WRo3LOg93BhUAFD3cvnVaCCR9tyH1lMiN8xuDlDbA";return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ne(t)})}).then(function(e){console.log(JSON.stringify({subscription:e})),document.body.innerHTML=JSON.stringify(e)}).catch(e=>{console.log(e),document.body.innerHTML=e.message})}var oe;const re={subscribe:se,registration:oe},ie={name:"EnableNotification",methods:{clicked(){i.currentUser.notifications==""&&(navigator.serviceWorker.register("service-worker.js"),navigator.serviceWorker.ready.then(function(e){return e.pushManager.getSubscription()}).then(async function(e){e?(console.log(JSON.stringify({subscription:e})),await i.instance.collection("users").update(i.currentUser.id,{notifications:JSON.stringify(e)})):re.subscribe()}))}}};function ce(e,t,a,h,c,d){return p(i).currentUser.username=="knixknax"?(o(),r("button",{key:0,id:"notify",onClick:t[0]||(t[0]=(...s)=>d.clicked&&d.clicked(...s))},"BENACHRICHTIGUNGEN")):b("",!0)}const ae=m(ie,[["render",ce]]),de={components:{Options:E},data(){return{currentUser:i.instance.authStore.model}},methods:{loading(e){const t=e;var a="L\xE4dt";t.innerHTML=a+".",setInterval(function(){t.innerHTML.length>a.length+3?t.innerHTML=a+".":t.innerHTML+="."},400)},async signOut(e){this.loading(e.srcElement),i.instance.authStore.clear()},async deleteAccount(e){const t=prompt("Willst du den Account wirklich l\xF6schen? (ja/nein)");this.currentUser&&t=="ja"&&i.instance.collection("users").delete(this.currentUser.id)}},mounted(){i.instance.authStore.onChange(e=>{this.currentUser=i.instance.authStore.model})}};const u=e=>(C("data-v-95e5d101"),e=e(),L(),e),_e={id:"main-content"},le={key:0,id:"main-settings"},ue={key:0},he={id:"main-heading"},pe=u(()=>n("br",null,null,-1)),ye=u(()=>n("br",null,null,-1)),me={id:"mail-notify"},fe={key:1},ge=u(()=>n("p",{id:"confirm"},"Bitte email best\xE4tigen und danach neu laden",-1)),ve=[ge],Ue={key:1},xe=u(()=>n("h1",null,"LMG Vertretungsplan Bot \u{1F916}",-1)),$e=u(()=>n("p",null,"Automatische Nachrichten zu deinen aktuellen Vertetungen/Entf\xE4llen (beta)",-1)),ke=u(()=>n("button",{id:"signin"},"ANMELDEN",-1)),be=u(()=>n("button",{id:"signin"},"ACCOUNT ERSTELLEN",-1));function Ee(e,t,a,h,c,d){var U;const s=j,f=te,N=E,O=ae,v=S;return o(),r("div",_e,[c.currentUser?(o(),r("div",le,[c.currentUser.verified?(o(),r("div",ue,[n("h1",he,"HALLO, "+_((U=c.currentUser)==null?void 0:U.email.split("@")[0].toUpperCase()),1),l(s,{currentUser:c.currentUser},null,8,["currentUser"]),l(f),l(N,{currentUser:c.currentUser},null,8,["currentUser"]),l(O),n("p",null,[y("Angemeldet!"),pe,y("(user-id: "+_(p(i).currentUser.id)+")",1),ye,y("( "),n("i",me,_(p(i).currentUser.email),1),y(")")])])):(o(),r("div",fe,ve)),n("button",{id:"signout",onClick:t[0]||(t[0]=g=>d.signOut(g))},"ABMELDEN"),n("button",{id:"delete",onClick:t[1]||(t[1]=g=>d.deleteAccount(g))},"ACCOUNT L\xD6SCHEN")])):(o(),r("div",Ue,[xe,$e,l(v,{to:"/login"},{default:x(()=>[ke]),_:1}),l(v,{to:"/signup"},{default:x(()=>[be]),_:1})]))])}const Le=m(de,[["render",Ee],["__scopeId","data-v-95e5d101"]]);export{Le as default};
