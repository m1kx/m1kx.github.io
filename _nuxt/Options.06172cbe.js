import{p as o}from"./pocketbase.0539cbe6.js";import{a as d,b as h,e as n,f as u,t as a,k as p,v as _,o as f}from"./entry.bfddb0cf.js";const b={name:"Options",data(){return{current:"",courses:"",loading_upd:!1}},props:{currentUser:o.currentUser},mounted(){this.courses=this.currentUser.subjects.replaceAll(":",","),this.current=this.currentUser.class,Object.keys(this.$refs).forEach(t=>{const e=this.$refs[t];e.innerHTML==this.current&&e.classList.add("selected")})},methods:{validCheck(){const t=document.getElementsByClassName("valid-check");let e=!0;for(let s=0;s<t.length;s++){const r=t[s];r.checkValidity()||(r.style.outline="3px dashed #942525",setTimeout(()=>{r.style.outline=""},4e3),e=!1)}return e},button_select(t){t.preventDefault();const e=t.srcElement;this.current=e.innerHTML;const s=document.getElementsByClassName("select");for(let r=0;r<s.length;r++){const l=s[r];if(e==l){e.classList.add("selected");continue}l.classList.remove("selected")}},loading(t){const e=t,s=t;s.disabled=!0;const r=t.innerHTML;var l="L\xE4dt";e.innerHTML=l+".",this.loading_upd=!0;var c=setInterval(()=>{if(!this.loading_upd){clearInterval(c),t.innerHTML=r,s.disabled=!1;return}e.innerHTML.length>l.length+3?e.innerHTML=l+".":e.innerHTML+="."},400)},async button_submit(t){if(!this.validCheck()){setTimeout(()=>{alert("Bitte richtige Werte in markierte felder eingeben...")},100);return}if(this.current==""){alert("Bitte eine Stufe angeben...");return}if(this.current==this.currentUser.class&&this.courses.replaceAll(",",":")==this.currentUser.subjects)return;this.loading(t.srcElement);const e={class:this.current,subjects:this.courses.replaceAll(", ",",").replaceAll(",",":")};try{await o.instance.collection("users").update(this.currentUser.id,e),await o.instance.collection("users").update(this.currentUser.id,{update:!0})}catch{alert("Ein unerwarteter Fehler ist aufgetreten, versuche es sp\xE4ter erneut..."),this.loading_upd=!1}this.loading_upd=!1}}};const g={id:"login",style:{"text-align":"center"}},m={id:"login-style",class:"area"},v=n("h2",{style:{"text-decoration":"underline","underline-offset":"10px","font-weight":"500","margin-top":"0"}},"Daten Aktualisieren",-1),k={class:"highlight"},y={class:"highlight"},x=n("label",null,"Kurse",-1),L=n("br",null,null,-1);function U(t,e,s,r,l,c){return f(),h("div",g,[n("div",m,[v,n("div",null,[u("(Kurse aktuell: "),n("div",k,a(s.currentUser.subjects.replaceAll(":",",")),1),u(" & Stufe: "),n("div",y,a(s.currentUser.class),1),u(")")]),x,p(n("input",{onkeyup:"this.value = this.value.toUpperCase();",class:"valid-check","onUpdate:modelValue":e[0]||(e[0]=i=>l.courses=i),id:"courses",type:"text",placeholder:"E G1,D G4,M L1,MU G1",pattern:"^[A-Z]{1,2}\\d?\\s[A-Z][1-9](,\\s?[A-Z]{1,2}\\d?\\s[A-Z][1-9])*$",required:""},null,512),[[_,l.courses]]),n("label",null,"Stufe: "+a(l.current),1),n("button",{ref:"select_button_1",class:"select",onClick:e[1]||(e[1]=i=>c.button_select(i))},"EF",512),n("button",{ref:"select_button_2",class:"select",onClick:e[2]||(e[2]=i=>c.button_select(i))},"Q1",512),n("button",{ref:"select_button_3",class:"select",onClick:e[3]||(e[3]=i=>c.button_select(i))},"Q2",512),L,n("button",{onClick:e[4]||(e[4]=i=>c.button_submit(i)),style:{"background-color":"rgba(255, 255, 255, 0.162)","margin-top":"35px",width:"50vw"}},"AKTUALISIEREN")])])}const A=d(b,[["render",U]]);export{A as O};
