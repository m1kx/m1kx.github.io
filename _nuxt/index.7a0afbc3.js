import{u as M}from"./pocketbase.452a775a.js";import{a as W,r as N,b as P,e as L,f as I,w as G,u as p,h as K,i as D,o as f,j as m,k as r,t as x,F as T,l as B,m as Z,p as V,q as j,s as k,v as q,x as Q,y as Y,z as J,A as R,B as z,C as U,D as X,E as ee,G as te}from"./entry.10c4824f.js";import{_ as ne}from"./_plugin-vue_export-helper.a1a6add7.js";const se=()=>null;function F(...u){var c,y,v,C,E,O,H;const a=typeof u[u.length-1]=="string"?u.pop():void 0;typeof u[0]!="string"&&u.unshift(a);let[e,o,t={}]=u;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(c=t.server)!=null?c:!0,t.default=(y=t.default)!=null?y:se,t.lazy=(v=t.lazy)!=null?v:!1,t.immediate=(C=t.immediate)!=null?C:!0;const n=W(),h=()=>n.isHydrating?n.payload.data[e]:n.static.data[e],l=()=>h()!==void 0;n._asyncData[e]||(n._asyncData[e]={data:N((H=(O=h())!=null?O:(E=t.default)==null?void 0:E.call(t))!=null?H:null),pending:N(!l()),error:N(n.payload._errors[e]?P(n.payload._errors[e]):null)});const s={...n._asyncData[e]};s.refresh=s.execute=(b={})=>{if(n._asyncDataPromises[e]){if(b.dedupe===!1)return n._asyncDataPromises[e];n._asyncDataPromises[e].cancelled=!0}if(b._initial&&l())return h();s.pending.value=!0;const w=new Promise((g,S)=>{try{g(o(n))}catch(A){S(A)}}).then(g=>{if(w.cancelled)return n._asyncDataPromises[e];t.transform&&(g=t.transform(g)),t.pick&&(g=ae(g,t.pick)),s.data.value=g,s.error.value=null}).catch(g=>{var S,A;if(w.cancelled)return n._asyncDataPromises[e];s.error.value=g,s.data.value=p((A=(S=t.default)==null?void 0:S.call(t))!=null?A:null)}).finally(()=>{w.cancelled||(s.pending.value=!1,n.payload.data[e]=s.data.value,s.error.value&&(n.payload._errors[e]=P(s.error.value)),delete n._asyncDataPromises[e])});return n._asyncDataPromises[e]=w,n._asyncDataPromises[e]};const _=()=>s.refresh({_initial:!0}),d=t.server!==!1&&n.payload.serverRendered;{const b=K();if(b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const g=b._nuxtOnBeforeMountCbs;b&&(L(()=>{g.forEach(S=>{S()}),g.splice(0,g.length)}),I(()=>g.splice(0,g.length)))}d&&n.isHydrating&&l()?s.pending.value=!1:b&&(n.payload.serverRendered&&n.isHydrating||t.lazy)&&t.immediate?b._nuxtOnBeforeMountCbs.push(_):t.immediate&&_(),t.watch&&G(t.watch,()=>s.refresh());const w=n.hook("app:data:refresh",g=>{if(!g||g.includes(e))return s.refresh()});b&&I(w)}const i=Promise.resolve(n._asyncDataPromises[e]).then(()=>s);return Object.assign(i,s),i}function ae(u,a){const e={};for(const o of a)e[o]=u[o];return e}const oe={key:0,class:"data-display"},re={key:0},ie={key:1},ce=D({__name:"DataDisplay",props:{heading:null,day:null},setup(u){const a=u,e=M();var o=e.authStore.model;e.authStore.onChange(h=>{o=e.authStore.model,window.location.reload()});var t=[];function n(h){let l=[];a.day=="h"?l=atob(h.h_hash).split("!!!"):l=atob(h.m_hash).split("!!!");for(let s=0;s<l.length;s++)l[s]=l[s].split("|");t=l}return L(()=>{!o||e.collection("users").subscribe(o.id,async h=>{n(h.record)})}),n(o),(h,l)=>p(t)?(f(),m("div",oe,[r("h2",null,x(u.heading),1),p(t)[0]!=""?(f(),m("div",re,[(f(!0),m(T,null,B(p(t),(s,_)=>(f(),m("div",{key:_},[r("p",null,[Z(x(s[1])+" "+x(s[2])+" ",1),r("i",null,x(s[5]),1)])]))),128))])):(f(),m("div",ie," Keine Ereignisse "))])):V("",!0)}}),le={id:"display-container",class:"area",pos:"top"},ue=r("div",{id:"seperator"},null,-1),de=D({__name:"Display",async setup(u){let a,e;const o=M();o.authStore.model,o.authStore.onChange(n=>{o.authStore.model});const{data:t}=([a,e]=j(async()=>F("dates",async()=>{const n=await o.collection("times").getOne("ux8ausqmf2h57dd");return{day_1:n.day_1,day_2:n.day_2}})),a=await a,e(),a);return(n,h)=>{var s,_;const l=ce;return f(),m("div",le,[k(l,{heading:(s=p(t))==null?void 0:s.day_1,day:"h"},null,8,["heading"]),ue,k(l,{heading:(_=p(t))==null?void 0:_.day_2,day:"m"},null,8,["heading"])])}}}),_e={class:"area",id:"score-display"},he={id:"score-content"},pe=r("h2",null,"EVA SCORE",-1),fe=r("h3",null,"DEIN SCORE",-1),me=r("h3",null,"TOP 5 SCORE",-1),ye={id:"your-score",class:"score"},ge={style:{margin:"0"}},ve=r("div",{id:"score-seperator"},null,-1),be={id:"top-score",class:"score"},xe={key:0},ke={key:0,style:{color:"rgb(157, 241, 154)"}},Ee={key:1},Ce=D({__name:"ScoreDisplay",async setup(u){let a,e;const o=M();var t=o.authStore.model;o.authStore.onChange(s=>{t=o.authStore.model});var n=[],h=0;const{data:l}=([a,e]=j(async()=>F("users",async()=>{n=await o.collection("users").getFullList(200,{}),n.sort((_,d)=>d.score+d.h_score-(_.score+_.h_score));for(let _=0;_<n.length;_++)if(n[_].id==(t==null?void 0:t.id)){h=_+1;break}return n.splice(5,n.length-5),n})),a=await a,e(),a);return(s,_)=>{var d,i;return f(),m("div",_e,[r("div",he,[pe,fe,me,r("div",ye,[r("div",null,[r("h2",null,x(((d=p(t))==null?void 0:d.score)+((i=p(t))==null?void 0:i.h_score)),1),r("h6",ge,"(Platz "+x(p(h))+")",1)])]),ve,r("div",be,[r("div",null,[(f(!0),m(T,null,B(p(l),(c,y)=>{var v;return f(),m("div",{key:y},[c.score+c.h_score!=0?(f(),m("div",xe,[c.id==((v=p(t))==null?void 0:v.id)?(f(),m("div",ke,x(c.score+c.h_score),1)):(f(),m("div",Ee,x(c.score+c.h_score),1))])):V("",!0)])}),128))])])])])}}}),De={id:"login-style",class:"area",pos:"bottom",style:{"text-align":"center"}},we=r("h2",{style:{"font-weight":"900","margin-top":"0"}},"DATEN \xC4NDERN",-1),Se=r("label",null,"Kurse",-1),Me=r("br",null,null,-1),$e=D({__name:"Options",setup(u){const a=M();var e=a.authStore.model;a.authStore.onChange(d=>{e=a.authStore.model});var o=N(""),t="",n=!1;function h(){const d=document.getElementsByClassName("valid-check");let i=!0;for(let c=0;c<d.length;c++){const y=d[c];y.checkValidity()||(y.style.outline="3px dashed #942525",setTimeout(()=>{y.style.outline=""},4e3),i=!1)}return i}function l(d){d.preventDefault();const i=d.srcElement;o.value=i.innerHTML;const c=document.getElementsByClassName("select");for(let y=0;y<c.length;y++){const v=c[y];if(i==v){i.classList.add("selected");continue}v.classList.remove("selected")}}function s(d){const i=d,c=d;c.disabled=!0;const y=d.innerHTML;var v="L\xE4dt";i.innerHTML=v+".",n=!0;var C=setInterval(()=>{if(!n){clearInterval(C),d.innerHTML=y,c.disabled=!1;return}i.innerHTML.length>v.length+3?i.innerHTML=v+".":i.innerHTML+="."},400)}async function _(d){if(!h()){setTimeout(()=>{alert("Bitte richtige Werte in markierte felder eingeben...")},100);return}if(o.value==""){alert("Bitte eine Stufe angeben...");return}if(o.value==e.class&&t.replaceAll(",",":")==e.subjects)return;s(d.srcElement);const i={class:o.value,subjects:t.replaceAll(", ",",").replaceAll(",",":"),new_update:!0};try{if(!e)return;await a.collection("users").update(e.id,i)}catch{alert("Ein unerwarteter Fehler ist aufgetreten, versuche es sp\xE4ter erneut..."),n=!1}n=!1}return L(()=>{!e||(t=e.subjects.replaceAll(":",","),o.value=e.class,a.collection("users").subscribe(e.id,async d=>{t=d.record.subjects.replaceAll(":",",")}))}),(d,i)=>(f(),m("div",De,[we,Se,q(r("input",{onkeyup:"this.value = this.value.toUpperCase();",class:"valid-check","onUpdate:modelValue":i[0]||(i[0]=c=>Y(t)?t.value=c:t=c),id:"courses",type:"text",placeholder:"E G1,D G4,M L1,MU G1",pattern:"^[A-Z]{1,2}\\d?\\s[A-Z][1-9](,\\s?[A-Z]{1,2}\\d?\\s[A-Z][1-9])*$",required:""},null,512),[[Q,p(t)]]),r("label",null,"Stufe: "+x(p(o)),1),r("button",{ref:"select_button_1",class:"select",onClick:i[1]||(i[1]=c=>l(c))},"EF",512),r("button",{ref:"select_button_2",class:"select",onClick:i[2]||(i[2]=c=>l(c))},"Q1",512),r("button",{ref:"select_button_3",class:"select",onClick:i[3]||(i[3]=c=>l(c))},"Q2",512),Me,r("button",{id:"update-button",onClick:i[4]||(i[4]=c=>_(c)),style:{"background-color":"rgba(255, 255, 255, 0.162)","margin-top":"23px",width:"50vw","font-size":"15px"}},"DATEN AKTUALISIEREN")]))}});function Ae(u){const a="=".repeat((4-u.length%4)%4),e=(u+a).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(e);return Uint8Array.from([...o].map(t=>t.charCodeAt(0)))}async function Ne(){try{const u=await navigator.serviceWorker.ready,a="BOYI_ijgk8RgymTmVmEu9_Kmtpun5-R790EByhTQ26Ba33WRo3LOg93BhUAFD3cvnVaCCR9tyH1lMiN8xuDlDbA",e=await u.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ae(a)});return await pb.instance.collection("users").update(pb.currentUser.id,{notifications:JSON.stringify(e)}),!0}catch(u){return console.log(u),alert(`Error: Version nicht unterstuetzt /
Benachrichtigungen abgelehnt`),!1}}var Le;const Te={subscribe:Ne,registration:Le},Be=D({__name:"EnableNotification",setup(u){const a=M();var e=a.authStore.model;a.authStore.onChange(h=>{e=a.authStore.model});var o=!1;function t(){return e?e.notifications!="":!1}async function n(){if(t()&&e){await a.collection("users").update(e.id,{notifications:""}),o=!1;return}navigator.serviceWorker.register("service-worker.js");const l=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(!l)o=await Te.subscribe();else{if(!e)return;await a.collection("users").update(e.id,{notifications:JSON.stringify(l)}),o=!0}}return L(()=>{!e||(o=e.notifications!="")}),(h,l)=>(f(),m("button",{class:J({disablenotification:p(o)}),id:"notify",onClick:n},"PUSH BENACHRICHTIGUNGEN",2))}}),Oe={class:"bg-shape-container"},He=D({__name:"BackgroundShape",props:{index:Number},setup(u){const a=u,o=Math.floor(Math.random()*(10-0+1)+0)>5?"50%":"0%",t=250,n=500;var h=R(`posx-${a.index}`,()=>Math.floor(Math.random()*(document.body.clientWidth-0+1)+0)),l=R(`posy-${a.index}`,()=>Math.floor(Math.random()*(document.body.clientHeight*1.7-n-0+1)+0));const s=Math.floor(Math.random()*(n-t+1)+t);var _=Math.floor(Math.random()*360),d="hsl("+_+", 100%, 85%)";const i=()=>{h.value=Math.floor(Math.random()*(document.body.clientWidth-0+1)+0),l.value=Math.floor(Math.random()*(document.body.clientHeight*1.7-n-0+1)+0)};return setInterval(()=>{i()},1e4),setTimeout(()=>{i()},1e3),(c,y)=>(f(),m("div",Oe,[r("div",{class:"bg-shape",style:z(`border-radius: ${p(o)}; transform: translateX(${p(h)}px) translateY(${p(l)}px); background-color: ${p(d)}; width: ${p(s)}px; height: ${p(s)}px;`)},null,4)]))}}),$=u=>(ee("data-v-db826f91"),u=u(),te(),u),Pe={class:"container-main"},Ie={id:"main-content"},Re={key:0,id:"main-settings"},Ue={key:0,id:"main-settings"},Ve={id:"main-heading"},je={key:1},ze=$(()=>r("p",{id:"confirm"},"Bitte email best\xE4tigen und danach neu laden",-1)),Fe=[ze],We={key:1},Ge=$(()=>r("h1",null,"LMG Vertretungsplan Bot \u{1F916}",-1)),Ke=$(()=>r("p",null,"Automatische Nachrichten zu deinen aktuellen Vertetungen/Entf\xE4llen (beta)",-1)),Ze=$(()=>r("button",{id:"signin"},"ANMELDEN",-1)),qe=$(()=>r("button",{id:"signin"},"ACCOUNT ERSTELLEN",-1)),Qe={id:"background"},Ye=D({__name:"index",setup(u){const a=M();var e=a.authStore.model;a.authStore.onChange(l=>{e=a.authStore.model,window.location.reload()});function o(l){const s=l;var _="L\xE4dt";s.innerHTML=_+".",setInterval(function(){s.innerHTML.length>_.length+3?s.innerHTML=_+".":s.innerHTML+="."},400)}async function t(l){o(l.srcElement),a.authStore.clear()}async function n(l){const s=prompt("Willst du den Account wirklich l\xF6schen? (ja/nein)");e&&s=="ja"&&a.collection("users").delete(e.id)}const h=document.body.clientHeight*1.8;return(l,s)=>{var C;const _=de,d=Ce,i=$e,c=Be,y=X,v=He;return f(),m("div",Pe,[r("div",Ie,[p(e)?(f(),m("div",Re,[p(e).verified?(f(),m("div",Ue,[r("h1",Ve,"HALLO, "+x((C=p(e))==null?void 0:C.email.split("@")[0].toUpperCase()),1),k(_),k(d),k(i),k(c)])):(f(),m("div",je,Fe)),r("button",{id:"signout",onClick:s[0]||(s[0]=E=>t(E))},"ABMELDEN"),r("button",{id:"delete",onClick:s[1]||(s[1]=E=>n())},"ACCOUNT L\xD6SCHEN")])):(f(),m("div",We,[Ge,Ke,k(y,{to:"/login"},{default:U(()=>[Ze]),_:1}),k(y,{to:"/signup"},{default:U(()=>[qe]),_:1})]))]),r("div",{id:"background-blur",style:z(`height: ${h}px;`)},null,4),r("div",Qe,[(f(),m(T,null,B(10,E=>k(v,{key:E,index:E},null,8,["index"])),64))])])}}});const tt=ne(Ye,[["__scopeId","data-v-db826f91"]]);export{tt as default};
